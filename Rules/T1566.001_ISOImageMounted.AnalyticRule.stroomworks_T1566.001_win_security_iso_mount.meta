{
  "analyticProcessType": "STREAMING",
  "duplicateNotificationConfig": {
    "chooseColumns": false,
    "columnNames": [],
    "rememberNotifications": false,
    "suppressDuplicateNotifications": false
  },
  "errorFeed": {
    "type": "Feed",
    "uuid": "8b95697a-1827-4e67-b982-940f3d47634c",
    "name": "RULE_ERRORS_FEED"
  },
  "includeRuleDocumentation": false,
  "languageVersion": "STROOM_QL_VERSION_0_1",
  "name": "T1566.001 - ISOImageMounted",
  "description": "Detects the mount of an ISO image on an endpoint\n\nLevel: medium\n\nStatus: test\n\nFalse Positives:\n- Software installation ISO files\n\nReferences:\n- https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/malicious-spam-campaign-uses-iso-image-files-to-deliver-lokibot-and-nanocore\n- https://www.proofpoint.com/us/blog/threat-insight/threat-actor-profile-ta2719-uses-colorful-lures-deliver-rats-local-languages\n- https://twitter.com/MsftSecIntel/status/1257324139515269121\n- https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1553.005/T1553.005.md#atomic-test-1---mount-iso-image\n\nTags:\n- attack.initial-access\n- attack.t1566.001\n\nSource Sigma rule author(s):\n- Syed Hasan (@syedhasan009)\n\nSource Sigma rule: win\\_security\\_iso\\_mount.yml",
  "notifications": [
    {
      "destination": {
        "type": "stream",
        "destinationFeed": {
          "type": "Feed",
          "uuid": "f58bb9a9-1359-4077-9451-f977b2b862c3",
          "name": "RULE_OUTPUT_FEED"
        },
        "useSourceFeedIfPossible": false
      },
      "destinationType": "STREAM",
      "enabled": true,
      "limitNotifications": false,
      "maxNotifications": 1,
      "resumeAfter": {
        "time": 1,
        "timeUnit": "DAYS"
      },
      "uuid": "9ed54c1d-6c2c-41e0-aae1-fe3a25c5f77c"
    }
  ],
  "query": "from RULE_VIEW\nwhere (System.EventID in (\"4663\")) and (System.EventID = 4663 and EventData.ObjectServer = 'Security' and EventData.ObjectType = 'File' and EventData.ObjectName = '*\\\\\\\\Device\\\\\\\\CdRom*') and not ((EventData.ObjectName = '*\\\\\\\\Device\\\\\\\\CdRom0\\\\\\\\autorun.ico*' or EventData.ObjectName = '*\\\\\\\\Device\\\\\\\\CdRom0\\\\\\\\setup.exe*' or EventData.ObjectName = '*\\\\\\\\Device\\\\\\\\CdRom0\\\\\\\\setup64.exe*'))\nselect *",
  "rememberNotifications": false,
  "suppressDuplicateNotifications": false,
  "timeRange": {
    "name": "All time",
    "condition": "BETWEEN"
  },
  "uuid": "stroomworks_T1566.001_win_security_iso_mount",
  "version": "c96e0000-dea0-4c3a-88cc-a107449521e1",
  "type": "AnalyticRule",
  "level": "medium",
  "status": "test"
}